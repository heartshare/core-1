admin.silkky.cloud {
	import default

	route /auth* {
		authp {
			backends {
				github_oauth2_backend {
					method oauth2
					realm github
					provider github
					client_id {env.GITHUB_CLIENT_ID}
					client_secret {env.GITHUB_CLIENT_SECRET}
					scopes user
					user github.com/TheSilkky add role superuser
				}
			}

		}
	}

	route /portainer* {
		authorize {
			set auth url /auth
			allow roles authp/superuser 
		}
		uri strip_prefix /portainer
		reverse_proxy portainer:9000
	}
}